
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Introducing Idris on the JVM and an Idris Android example - mmhelloworld</title>
  <meta name="author" content="Marimuthu">

  
  <meta name="description" content="Idris on the JVM! Yes, a dependently typed language on the JVM!
I have been working on a JVM bytecode backend for Idris for the past few months and &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mmhelloworld.github.io/blog/2017/01/06/introducing-idris-on-the-jvm-and-an-idris-android-example">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="mmhelloworld" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">mmhelloworld</a></h1>
  
    <h2>main = println "Hello World!"</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:mmhelloworld.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Introducing Idris on the JVM and an Idris Android example</h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-01-06T22:51:00-05:00" pubdate data-updated="true">Jan 6<span>th</span>, 2017</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><a href="https://github.com/mmhelloworld/idris-jvm">Idris on the JVM!</a> Yes, a dependently typed language on the JVM!
I have been working on a <a href="https://github.com/mmhelloworld/idris-jvm">JVM bytecode backend for Idris</a> for the past few months and
it is now at a point that we can even write Android programs with Idris without having to write a single line of Java.
In this post, we will see how Idris works on the JVM and an example Android program written in Idris.</p>

<h2>Hello World</h2>

<figure class='code'><figcaption><span>hellworld.idr</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="kr">module</span> <span class="nn">Main</span>
</span><span class='line'>
</span><span class='line'><span class="nf">main</span> <span class="kt">:</span> <span class="kt">IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">main</span> <span class="ow">=</span> <span class="n">printLn</span> <span class="s">&quot;Hello World&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<h6>Compile:</h6>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>idrisjvm helloworld.idr -o target
</span></code></pre></td></tr></table></div></figure>


<p>Here <code>idrisjvm</code> is just a wrapper around Idris command itself with few default options: <code>idris --codegen jvm -p idrisjvmruntime</code>.
Dependencies are provided as Idris packages, not as Java dependencies like jar or class files.
The overall process is that the compiler reads Idris files and converts them into Idris bytecode files (<code>*.ibc</code>) and
the JVM bytecode generator takes the <code>ibc</code> files and converts them into JVM bytecode class files directly.
It is only when we run a Java class, we have to provide Java dependency jars. The output option <code>-o</code> represents a directory
where the Java class files will be created.</p>

<h6>Run:</h6>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>java -cp target:/path/to/idris-jvm-runtime-1.0-SNAPSHOT.jar main.Main
</span><span class='line'><span class="s2">&quot;Hello World&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And the output folder contains,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>tree target
</span><span class='line'>target
</span><span class='line'>├── Decidable
</span><span class='line'>│   └── Equality.class
</span><span class='line'>├── main
</span><span class='line'>│   └── Main.class
</span><span class='line'>└── Prelude
</span><span class='line'>    ├── Basics.class
</span><span class='line'>    ├── Bool.class
</span><span class='line'>    ├── Chars.class
</span><span class='line'>    ├── Interfaces.class
</span><span class='line'>    ├── Show.class
</span><span class='line'>    └── Strings.class
</span></code></pre></td></tr></table></div></figure>


<p>Why do we have all these classes? We only compiled <code>Main</code> module! This is because Idris performs whole program analysis/compilation
and code generator generates bytecode for all the modules that are relevant for the result produced by the main program.</p>

<h2>How does Idris JVM handle tail calls?</h2>

<p>Idris JVM eliminates self-recursion with JVM <code>GOTO</code> and uses trampolines for other tail calls.
Let&rsquo;s look at the following examples.</p>

<h5>self-recursion example</h5>

<figure class='code'><figcaption><span>selfrecursion.idr</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="kr">module</span> <span class="nn">Main</span>
</span><span class='line'>
</span><span class='line'><span class="kr">import</span> <span class="nn">IdrisJvm.IO</span>
</span><span class='line'>
</span><span class='line'><span class="nf">sum</span> <span class="kt">:</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">Nat</span>
</span><span class='line'><span class="nf">sum</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">go</span> <span class="mi">0</span> <span class="n">n</span> <span class="kr">where</span>
</span><span class='line'>  <span class="n">go</span> <span class="kt">:</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">Nat</span>
</span><span class='line'>  <span class="n">go</span> <span class="n">acc</span> <span class="kt">Z</span> <span class="ow">=</span> <span class="n">acc</span>
</span><span class='line'>  <span class="n">go</span> <span class="n">acc</span> <span class="n">n</span><span class="o">@</span><span class="p">(</span><span class="kt">S</span> <span class="n">k</span><span class="p">)</span> <span class="ow">=</span> <span class="n">go</span> <span class="p">(</span><span class="n">acc</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="n">k</span>
</span><span class='line'>
</span><span class='line'><span class="nf">main</span> <span class="kt">:</span> <span class="kt">JVM_IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">main</span> <span class="ow">=</span> <span class="n">printLn</span> <span class="p">(</span><span class="n">sum</span> <span class="mi">50000</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This program would work just fine without blowing up the stack as it will be compiled down to a loop that uses JVM&rsquo;s <code>GOTO</code> instruction.
Here is the relevant section from bytecode:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>javap -c -cp target:/path/to/idris-jvm-runtime-1.0-SNAPSHOT.jar main.Main
</span><span class='line'>
</span><span class='line'>  public static java.lang.Object sum<span class="nv">$whr$go$colon$0</span><span class="o">(</span>java.lang.Object, java.lang.Object, java.lang.Object<span class="o">)</span>;
</span><span class='line'>    Code:
</span><span class='line'>       0: aconst_null
</span><span class='line'>       1: astore        7
</span><span class='line'>       3: aconst_null
</span><span class='line'>       4: astore_3
</span><span class='line'>       5: aconst_null
</span><span class='line'>       6: astore        4
</span><span class='line'>       8: aconst_null
</span><span class='line'>       9: astore        5
</span><span class='line'>      11: aconst_null
</span><span class='line'>      12: astore        6
</span><span class='line'>      14: iconst_1
</span><span class='line'>      15: istore        8
</span><span class='line'>      17: iload         8
</span><span class='line'>      19: ifeq          130
</span><span class='line'>      22: aload_2
</span><span class='line'>      23: new           <span class="c">#80                 // class java/math/BigInteger</span>
</span><span class='line'>      26: dup
</span><span class='line'>      27: ldc           <span class="c">#82                 // String 0</span>
</span><span class='line'>      29: invokespecial <span class="c">#85                 // Method java/math/BigInteger.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span>
</span><span class='line'>      32: invokestatic  <span class="c">#333                // Method mmhelloworld/idrisjvmruntime/Util.equals:(Ljava/lang/Object;Ljava/lang/Object;)Z</span>
</span><span class='line'>      35: ifeq          47
</span><span class='line'>      38: aload_1
</span><span class='line'>      39: astore        7
</span><span class='line'>      41: iconst_0
</span><span class='line'>      42: istore        8
</span><span class='line'>      44: goto          127
</span><span class='line'>      47: new           <span class="c">#80                 // class java/math/BigInteger</span>
</span><span class='line'>      50: dup
</span><span class='line'>      51: ldc_w         <span class="c">#335                // String 1</span>
</span><span class='line'>      54: invokespecial <span class="c">#85                 // Method java/math/BigInteger.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span>
</span><span class='line'>      57: astore_3
</span><span class='line'>      58: aload_2
</span><span class='line'>      59: invokestatic  <span class="c">#103                // Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)Ljava/math/BigInteger;</span>
</span><span class='line'>      62: aload_3
</span><span class='line'>      63: invokestatic  <span class="c">#103                // Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)Ljava/math/BigInteger;</span>
</span><span class='line'>      66: invokevirtual <span class="c">#338                // Method java/math/BigInteger.subtract:(Ljava/math/BigInteger;)Ljava/math/BigInteger;</span>
</span><span class='line'>      69: astore_3
</span><span class='line'>      70: new           <span class="c">#80                 // class java/math/BigInteger</span>
</span><span class='line'>      73: dup
</span><span class='line'>      74: ldc_w         <span class="c">#335                // String 1</span>
</span><span class='line'>      77: invokespecial <span class="c">#85                 // Method java/math/BigInteger.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span>
</span><span class='line'>      80: astore        4
</span><span class='line'>      82: aload_3
</span><span class='line'>      83: invokestatic  <span class="c">#103                // Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)Ljava/math/BigInteger;</span>
</span><span class='line'>      86: aload         4
</span><span class='line'>      88: invokestatic  <span class="c">#103                // Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)Ljava/math/BigInteger;</span>
</span><span class='line'>      91: invokevirtual <span class="c">#107                // Method java/math/BigInteger.add:(Ljava/math/BigInteger;)Ljava/math/BigInteger;</span>
</span><span class='line'>      94: astore        4
</span><span class='line'>      96: iconst_0
</span><span class='line'>      97: invokestatic  <span class="c">#41                 // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span>
</span><span class='line'>     100: astore        5
</span><span class='line'>     102: aload_1
</span><span class='line'>     103: invokestatic  <span class="c">#103                // Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)Ljava/math/BigInteger;</span>
</span><span class='line'>     106: aload         4
</span><span class='line'>     108: invokestatic  <span class="c">#103                // Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)Ljava/math/BigInteger;</span>
</span><span class='line'>     111: invokevirtual <span class="c">#107                // Method java/math/BigInteger.add:(Ljava/math/BigInteger;)Ljava/math/BigInteger;</span>
</span><span class='line'>     114: astore        6
</span><span class='line'>     116: aload         5
</span><span class='line'>     118: astore_0
</span><span class='line'>     119: aload         6
</span><span class='line'>     121: astore_1
</span><span class='line'>     122: aload_3
</span><span class='line'>     123: astore_2
</span><span class='line'>     124: goto          127
</span><span class='line'>     127: goto          17
</span><span class='line'>     130: aload         7
</span><span class='line'>     132: areturn
</span></code></pre></td></tr></table></div></figure>


<p>The third line from the last is the <code>GOTO</code> instruction that transfers the control back to the top of function instead of
actually calling the function.</p>

<h5>Mutual recursion example:</h5>

<figure class='code'><figcaption><span>mutualrecursion.idr</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="kr">module</span> <span class="nn">Main</span>
</span><span class='line'>
</span><span class='line'><span class="nf">mutual</span>
</span><span class='line'>  <span class="n">evenT</span> <span class="kt">:</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="kt">Bool</span>
</span><span class='line'>  <span class="n">evenT</span> <span class="kt">Z</span> <span class="ow">=</span> <span class="n">pure</span> <span class="kt">True</span>
</span><span class='line'>  <span class="n">evenT</span> <span class="p">(</span><span class="kt">S</span> <span class="n">k</span><span class="p">)</span> <span class="ow">=</span> <span class="n">oddT</span> <span class="n">k</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">oddT</span> <span class="kt">:</span> <span class="kt">Nat</span> <span class="ow">-&gt;</span> <span class="kt">IO</span> <span class="kt">Bool</span>
</span><span class='line'>  <span class="n">oddT</span> <span class="kt">Z</span> <span class="ow">=</span> <span class="n">pure</span> <span class="kt">False</span>
</span><span class='line'>  <span class="n">oddT</span> <span class="p">(</span><span class="kt">S</span> <span class="n">k</span><span class="p">)</span> <span class="ow">=</span> <span class="n">evenT</span> <span class="n">k</span>
</span><span class='line'>
</span><span class='line'><span class="nf">main</span> <span class="kt">:</span> <span class="kt">IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">main</span> <span class="ow">=</span> <span class="n">printLn</span> <span class="o">!</span><span class="p">(</span><span class="n">evenT</span> <span class="mi">9999</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above code also would work fine without killing the stack. Mutual recursion is handled using trampolines and
the tail calls are delayed and compiled down to Java 8 lambdas. As the bytecode for this is bit long, here is the
decompiled bytecode for the <code>evenT</code> function:</p>

<figure class='code'><figcaption><span>Decompiled bytecode for evenT</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="n">Object</span> <span class="nf">evenT</span><span class="o">(</span><span class="n">Object</span> <span class="n">var0</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">Object</span> <span class="n">var4</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>    <span class="n">Integer</span> <span class="n">var1</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>    <span class="n">Integer</span> <span class="n">var2</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>    <span class="n">Object</span><span class="o">[]</span> <span class="n">var3</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="n">Util</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">var0</span><span class="o">,</span> <span class="k">new</span> <span class="n">BigInteger</span><span class="o">(</span><span class="s">&quot;0&quot;</span><span class="o">)))</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">var1</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span><span class='line'>        <span class="n">var2</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span><span class='line'>        <span class="n">var3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]{</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">1</span><span class="o">)};</span>
</span><span class='line'>        <span class="n">var4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]{</span><span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">65648</span><span class="o">),</span> <span class="n">var1</span><span class="o">,</span> <span class="n">var2</span><span class="o">,</span> <span class="n">var3</span><span class="o">};</span>
</span><span class='line'>    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">BigInteger</span> <span class="n">var5</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BigInteger</span><span class="o">(</span><span class="s">&quot;1&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">var5</span> <span class="o">=</span> <span class="n">Util</span><span class="o">.</span><span class="na">asBigInt</span><span class="o">(</span><span class="n">var0</span><span class="o">).</span><span class="na">subtract</span><span class="o">(</span><span class="n">Util</span><span class="o">.</span><span class="na">asBigInt</span><span class="o">(</span><span class="n">var5</span><span class="o">));</span>
</span><span class='line'>        <span class="n">var4</span> <span class="o">=</span> <span class="n">Runtime</span><span class="o">.</span><span class="na">thunk</span><span class="o">((</span><span class="n">var0</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="nf">oddT</span><span class="o">(</span><span class="n">var0</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
</span><span class='line'>        <span class="o">},</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]{</span><span class="n">var5</span><span class="o">});</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">var4</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>As we can see from the decompiled output above, the <code>oddT</code> call is not performed on the same call stack but a thunk
wrapping the function call is returned using lambda (which is compiled down to JVM&rsquo;s <code>invokedynamic</code> instruction).</p>

<p>Here is the relevant bit from bytecode for those who are interested:</p>

<figure class='code'><figcaption><span>bytecode for evenT</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'>    <span class="mi">76</span><span class="o">:</span> <span class="k">new</span>           <span class="err">#</span><span class="mi">61</span>                 <span class="c1">// class java/math/BigInteger</span>
</span><span class='line'>    <span class="mi">79</span><span class="o">:</span> <span class="n">dup</span>
</span><span class='line'>    <span class="mi">80</span><span class="o">:</span> <span class="n">ldc</span>           <span class="err">#</span><span class="mi">75</span>                 <span class="c1">// String 1</span>
</span><span class='line'>    <span class="mi">82</span><span class="o">:</span> <span class="n">invokespecial</span> <span class="err">#</span><span class="mi">66</span>                 <span class="c1">// Method java/math/BigInteger.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V</span>
</span><span class='line'>    <span class="mi">85</span><span class="o">:</span> <span class="n">astore_1</span>
</span><span class='line'>    <span class="mi">86</span><span class="o">:</span> <span class="n">aload_0</span>
</span><span class='line'>    <span class="mi">87</span><span class="o">:</span> <span class="n">invokestatic</span>  <span class="err">#</span><span class="mi">79</span>                 <span class="c1">// Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)</span>
</span><span class='line'><span class="n">Ljava</span><span class="o">/</span><span class="n">math</span><span class="o">/</span><span class="n">BigInteger</span><span class="o">;</span>
</span><span class='line'>    <span class="mi">90</span><span class="o">:</span> <span class="n">aload_1</span>
</span><span class='line'>    <span class="mi">91</span><span class="o">:</span> <span class="n">invokestatic</span>  <span class="err">#</span><span class="mi">79</span>                 <span class="c1">// Method mmhelloworld/idrisjvmruntime/Util.asBigInt:(Ljava/lang/Object;)</span>
</span><span class='line'><span class="n">Ljava</span><span class="o">/</span><span class="n">math</span><span class="o">/</span><span class="n">BigInteger</span><span class="o">;</span>
</span><span class='line'>    <span class="mi">94</span><span class="o">:</span> <span class="n">invokevirtual</span> <span class="err">#</span><span class="mi">83</span>                 <span class="c1">// Method java/math/BigInteger.subtract:(Ljava/math/BigInteger;)Ljava/math/BigInteger;</span>
</span><span class='line'>    <span class="mi">97</span><span class="o">:</span> <span class="n">astore_1</span>
</span><span class='line'>    <span class="mi">98</span><span class="o">:</span> <span class="n">invokedynamic</span> <span class="err">#</span><span class="mi">88</span><span class="o">,</span>  <span class="mi">0</span>             <span class="c1">// InvokeDynamic #1:apply:()Lmmhelloworld/idrisjvmruntime/Function;</span>
</span><span class='line'>   <span class="mi">103</span><span class="o">:</span> <span class="n">iconst_1</span>
</span><span class='line'>   <span class="mi">104</span><span class="o">:</span> <span class="n">anewarray</span>     <span class="err">#</span><span class="mi">4</span>                  <span class="c1">// class java/lang/Object</span>
</span><span class='line'>   <span class="mi">107</span><span class="o">:</span> <span class="n">dup</span>
</span><span class='line'>   <span class="mi">108</span><span class="o">:</span> <span class="n">iconst_0</span>
</span><span class='line'>   <span class="mi">109</span><span class="o">:</span> <span class="n">aload_1</span>
</span><span class='line'>   <span class="mi">110</span><span class="o">:</span> <span class="n">aastore</span>
</span><span class='line'>   <span class="mi">111</span><span class="o">:</span> <span class="n">invokestatic</span>  <span class="err">#</span><span class="mi">58</span>                 <span class="c1">// Method mmhelloworld/idrisjvmruntime/Runtime.thunk:(Lmmhelloworld/idrisjvmruntime/Function;[Ljava/lang/Object;)Lmmhelloworld/idrisjvmruntime/Thunk;</span>
</span><span class='line'>   <span class="mi">114</span><span class="o">:</span> <span class="n">astore</span>        <span class="mi">4</span>
</span><span class='line'>   <span class="mi">116</span><span class="o">:</span> <span class="k">goto</span>          <span class="mi">119</span>
</span><span class='line'>   <span class="mi">119</span><span class="o">:</span> <span class="n">aload</span>         <span class="mi">4</span>
</span><span class='line'>   <span class="mi">121</span><span class="o">:</span> <span class="n">areturn</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Java interoperability: Calling Java from Idris and calling Idris from Java</h2>

<p>Idris JVM supports calling Java static methods, instance methods, constructors and also accessing static and instance fields from Idris.
At the moment, except for Java arrays, all the Java types can be constructed from Idris and passed to Java methods.
Support for handling nulls and exceptions is currently in progress and will soon be available.
(Update 01/10/2017: We can now
<a href="http://mmhelloworld.github.io/blog/2017/01/10/idris-jvm-guarding-against-java-null-using-maybe-type/">use <code>Maybe</code> type to avoid Java nulls</a>
in Idris code)</p>

<p>To use Idris functions from Java, Idris JVM supports exporting Idris functions as static methods, instance methods,
constructors of an exported Java class. The exported class can also extend a Java class or implement interfaces with Idris functions.</p>

<p>To demonstrate these features, let&rsquo;s create an Android application In Idris.</p>

<h3>An Android application in Idris</h3>

<figure class='code'><figcaption><span>idrisandroid.idr</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
</pre></td><td class='code'><pre><code class='haskell'><span class='line'><span class="kr">module</span> <span class="nn">Main</span>
</span><span class='line'>
</span><span class='line'><span class="kr">import</span> <span class="nn">IdrisJvm.IO</span>
</span><span class='line'><span class="kr">import</span> <span class="nn">Java.Lang</span>
</span><span class='line'>
</span><span class='line'><span class="nf">pythag</span> <span class="kt">:</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">List</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span>
</span><span class='line'><span class="nf">pythag</span> <span class="n">max</span> <span class="ow">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">|</span> <span class="n">z</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">max</span><span class="p">],</span> <span class="n">y</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">z</span><span class="p">],</span> <span class="n">x</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="n">y</span><span class="p">],</span>
</span><span class='line'>                          <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">==</span> <span class="n">z</span> <span class="o">*</span> <span class="n">z</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="kt">IdrisAndroidActivity</span> <span class="kt">:</span> <span class="kt">Type</span>
</span><span class='line'><span class="kt">IdrisAndroidActivity</span> <span class="ow">=</span> <span class="kt">JVM_Native</span> <span class="o">$</span> <span class="kt">Class</span> <span class="s">&quot;hello/IdrisAndroidActivity&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">Bundle</span> <span class="kt">:</span> <span class="kt">Type</span>
</span><span class='line'><span class="kt">Bundle</span> <span class="ow">=</span> <span class="kt">JVM_Native</span> <span class="o">$</span> <span class="kt">Class</span> <span class="s">&quot;android/os/Bundle&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">Context</span> <span class="kt">:</span> <span class="kt">Type</span>
</span><span class='line'><span class="kt">Context</span> <span class="ow">=</span> <span class="kt">JVM_Native</span> <span class="o">$</span> <span class="kt">Class</span> <span class="s">&quot;android/content/Context&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">View</span> <span class="kt">:</span> <span class="kt">Type</span>
</span><span class='line'><span class="kt">View</span> <span class="ow">=</span> <span class="kt">JVM_Native</span> <span class="o">$</span> <span class="kt">Class</span> <span class="s">&quot;android/view/View&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">TextView</span> <span class="kt">:</span> <span class="kt">Type</span>
</span><span class='line'><span class="kt">TextView</span> <span class="ow">=</span> <span class="kt">JVM_Native</span> <span class="o">$</span> <span class="kt">Class</span> <span class="s">&quot;android/widget/TextView&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">Inherits</span> <span class="kt">View</span> <span class="kt">TextView</span> <span class="kr">where</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">CharSequence</span> <span class="kt">:</span> <span class="kt">Type</span>
</span><span class='line'><span class="kt">CharSequence</span> <span class="ow">=</span> <span class="kt">JVM_Native</span> <span class="o">$</span> <span class="kt">Class</span> <span class="s">&quot;java/lang/CharSequence&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kt">Inherits</span> <span class="kt">CharSequence</span> <span class="kt">String</span> <span class="kr">where</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="nf">superOnCreate</span> <span class="kt">:</span> <span class="kt">IdrisAndroidActivity</span> <span class="ow">-&gt;</span> <span class="kt">Bundle</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">superOnCreate</span> <span class="ow">=</span> <span class="n">invokeInstance</span> <span class="s">&quot;superOnCreate&quot;</span> <span class="p">(</span><span class="kt">IdrisAndroidActivity</span> <span class="ow">-&gt;</span> <span class="kt">Bundle</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="nb">()</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">getApplicationContext</span> <span class="kt">:</span> <span class="kt">IdrisAndroidActivity</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="kt">Context</span>
</span><span class='line'><span class="nf">getApplicationContext</span> <span class="ow">=</span> <span class="n">invokeInstance</span> <span class="s">&quot;getApplicationContext&quot;</span> <span class="p">(</span><span class="kt">IdrisAndroidActivity</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="kt">Context</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">newTextView</span> <span class="kt">:</span> <span class="kt">Context</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="kt">TextView</span>
</span><span class='line'><span class="nf">newTextView</span> <span class="ow">=</span> <span class="kt">FFI</span><span class="o">.</span><span class="n">new</span> <span class="p">(</span><span class="kt">Context</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="kt">TextView</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">setText</span> <span class="kt">:</span> <span class="kt">Inherits</span> <span class="kt">CharSequence</span> <span class="n">charSequence</span> <span class="ow">=&gt;</span> <span class="kt">TextView</span> <span class="ow">-&gt;</span> <span class="n">charSequence</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">setText</span> <span class="n">this</span> <span class="n">text</span> <span class="ow">=</span> <span class="n">invokeInstance</span> <span class="s">&quot;setText&quot;</span> <span class="p">(</span><span class="kt">TextView</span> <span class="ow">-&gt;</span> <span class="kt">CharSequence</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="nb">()</span><span class="p">)</span> <span class="n">this</span> <span class="p">(</span><span class="n">believe_me</span> <span class="n">text</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">setContentView</span> <span class="kt">:</span> <span class="kt">Inherits</span> <span class="kt">View</span> <span class="n">view</span> <span class="ow">=&gt;</span> <span class="kt">IdrisAndroidActivity</span> <span class="ow">-&gt;</span> <span class="n">view</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">setContentView</span> <span class="n">this</span> <span class="n">view</span> <span class="ow">=</span> <span class="n">invokeInstance</span> <span class="s">&quot;setContentView&quot;</span> <span class="p">(</span><span class="kt">IdrisAndroidActivity</span> <span class="ow">-&gt;</span> <span class="kt">View</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="nb">()</span><span class="p">)</span> <span class="n">this</span> <span class="p">(</span><span class="n">believe_me</span> <span class="n">view</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nf">onCreate</span> <span class="kt">:</span> <span class="kt">IdrisAndroidActivity</span> <span class="ow">-&gt;</span> <span class="kt">Bundle</span> <span class="ow">-&gt;</span> <span class="kt">JVM_IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">onCreate</span> <span class="n">this</span> <span class="n">bundle</span> <span class="ow">=</span> <span class="kr">do</span>
</span><span class='line'>  <span class="n">superOnCreate</span> <span class="n">this</span> <span class="n">bundle</span>
</span><span class='line'>  <span class="n">context</span> <span class="ow">&lt;-</span> <span class="n">getApplicationContext</span> <span class="n">this</span>
</span><span class='line'>  <span class="n">textView</span> <span class="ow">&lt;-</span> <span class="n">newTextView</span> <span class="n">context</span>
</span><span class='line'>  <span class="n">setText</span> <span class="n">textView</span> <span class="o">$</span> <span class="s">&quot;Hello Android from Idris! pythag 50 is &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="p">(</span><span class="n">pythag</span> <span class="mi">50</span><span class="p">)</span>
</span><span class='line'>  <span class="n">setContentView</span> <span class="n">this</span> <span class="n">textView</span>
</span><span class='line'>
</span><span class='line'><span class="nf">main</span> <span class="kt">:</span> <span class="kt">IO</span> <span class="nb">()</span>
</span><span class='line'><span class="nf">main</span> <span class="ow">=</span> <span class="n">pure</span> <span class="nb">()</span>
</span><span class='line'>
</span><span class='line'><span class="nf">androidExport</span><span class="kt">:</span> <span class="kt">FFI_Export</span> <span class="kt">FFI_JVM</span> <span class="s">&quot;hello/IdrisAndroidActivity extends android/support/v7/app/AppCompatActivity&quot;</span> <span class="kt">[]</span>
</span><span class='line'><span class="nf">androidExport</span> <span class="ow">=</span>
</span><span class='line'>  <span class="kt">Fun</span> <span class="n">superOnCreate</span> <span class="p">(</span><span class="kt">Super</span> <span class="s">&quot;onCreate&quot;</span><span class="p">)</span> <span class="o">$</span>
</span><span class='line'>  <span class="kt">Fun</span> <span class="n">onCreate</span> <span class="p">(</span><span class="kt">ExportInstance</span> <span class="s">&quot;onCreate&quot;</span><span class="p">)</span> <span class="o">$</span>
</span><span class='line'>  <span class="kt">End</span>
</span></code></pre></td></tr></table></div></figure>


<p>The above program demonstrates calling Java instance methods (<code>setText</code> for example) and constructors (<code>newTextView</code>).</p>

<p>It further demonstrates how to handle inheritance relationship when passing subclass instances to a parent class type.
For example, function <code>setContentView</code> takes a <code>View</code> but we can pass a <code>TextView</code> as it is a subclass of <code>View</code> and we
mention that to Idris via <code>Inherits View TextView where {}</code>.</p>

<p>It also demonstrates how we can create a Java class that extends another class and override methods with Idris functions.
The last section <code>androidExport</code> creates a Java class named <code>hello/IdrisAndroidActivity</code> that extends <code>android/support/v7/app/AppCompatActivity</code>.
The Java class also creates a wrapper method <code>superOnCreate</code> that just delegates to <code>super.OnCreate</code> and the class also overrides <code>onCreate</code> method
with Idris&#8217; <code>onCreate</code> function. The Java class can also implement one or more Java interfaces with something like,</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>hello/IdrisAndroidActivity extends android/support/v7/app/AppCompatActivity implements java/lang/Runnable, java/lang/Comparable
</span></code></pre></td></tr></table></div></figure>


<p>A module can have multiple exports so we can actually create multiple Java classes with Idris implementation functions from an Idris module.</p>

<p>We can compile this as usual,</p>

<p><code>idrisjvm idrisandroid.idr -o target</code></p>

<p>It would produce the following class files:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>tree target/
</span><span class='line'>target/
</span><span class='line'>├── Decidable
</span><span class='line'>│   └── Equality.class
</span><span class='line'>├── hello
</span><span class='line'>│   └── IdrisAndroidActivity.class
</span><span class='line'>├── main
</span><span class='line'>│   ├── Main.class
</span><span class='line'>│   └── Prelude.class
</span><span class='line'>└── Prelude
</span><span class='line'>    ├── Algebra.class
</span><span class='line'>    ├── Applicative.class
</span><span class='line'>    ├── Bool.class
</span><span class='line'>    ├── Foldable.class
</span><span class='line'>    ├── Interfaces.class
</span><span class='line'>    ├── List.class
</span><span class='line'>    ├── Monad.class
</span><span class='line'>    ├── Show.class
</span><span class='line'>    └── Strings.class
</span></code></pre></td></tr></table></div></figure>


<h5>Deploying to Android:</h5>

<ol>
<li>Create an android project using Android studio with <a href="https://developer.android.com/guide/platform/j8-jack.html#configuration">Jack support for Java 8</a>.</li>
<li>Then package the classes compiled above along with idris-jvm-runtime-1.0-SNAPSHOT.jar classes in a single jar and copy into an
android project&rsquo;s <code>app/libs</code> directory.</li>
<li>Change the activity class name in android manifest file to the Idris exported class name <code>hello.IdrisAndroidActivity</code>.</li>
<li>Then run <code>./gradlew installDebug</code> from android project after starting an emulator or connected to an android device.</li>
<li>Finally we should see our Idris code running on Android! It should look something like this:
<img class="center" src="/images/idris-android.png"></li>
</ol>


<p>Happy coding!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Marimuthu</span></span>

      








  


<time datetime="2017-01-06T22:51:00-05:00" pubdate data-updated="true">Jan 6<span>th</span>, 2017</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/android/'>Android</a>, <a class='category' href='/blog/categories/idris/'>Idris</a>, <a class='category' href='/blog/categories/jvm/'>JVM</a>, <a class='category' href='/blog/categories/java/'>Java</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://mmhelloworld.github.io/blog/2017/01/06/introducing-idris-on-the-jvm-and-an-idris-android-example/" data-via="marimuthum" data-counturl="http://mmhelloworld.github.io/blog/2017/01/06/introducing-idris-on-the-jvm-and-an-idris-android-example/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/02/27/haskell-on-the-jvm-via-ghcjs-and-nashorn/" title="Previous Post: Haskell on the JVM via GHCJS and Nashorn">&laquo; Haskell on the JVM via GHCJS and Nashorn</a>
      
      
        <a class="basic-alignment right" href="/blog/2017/01/10/idris-jvm-guarding-against-java-null-using-maybe-type/" title="Next Post: Idris JVM: Guarding against Java null using Maybe type">Idris JVM: Guarding against Java null using Maybe type &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/01/10/idris-jvm-guarding-against-java-null-using-maybe-type/">Idris JVM: Guarding against Java null using Maybe type</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/06/introducing-idris-on-the-jvm-and-an-idris-android-example/">Introducing Idris on the JVM and an Idris Android example</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/27/haskell-on-the-jvm-via-ghcjs-and-nashorn/">Haskell on the JVM via GHCJS and Nashorn</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/15/frege-record-accessors-and-mutators/">Frege: Record accessors and mutators</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/07/10/frege-hello-java/">Frege: Hello Java</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/mmhelloworld">@mmhelloworld</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mmhelloworld',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Marimuthu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'mmhelloworld';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://mmhelloworld.github.io/blog/2017/01/06/introducing-idris-on-the-jvm-and-an-idris-android-example/';
        var disqus_url = 'http://mmhelloworld.github.io/blog/2017/01/06/introducing-idris-on-the-jvm-and-an-idris-android-example/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
